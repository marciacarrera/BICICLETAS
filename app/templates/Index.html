{% from "_formsH.html" import render_field %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE-edge">
        <meta name ="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="..\static\css\index.css">

        <title>Inicio</title>
        <style>
            .hidden {
                display: None;
                padding: 25px;
                margin-bottom: 50px;
            }
        </style>
    </head>
    <body>
        <h1>Agregar bicicleta - venta</h1>
        <div class="main">
            <div class="form">
                <form method=post class="formulario">

                    {{ render_field(form.marca) }}
                    {{ render_field(form.modelo) }}
                    {{ render_field(form.aro) }}
                    {{ render_field(form.color) }}
                    {{ render_field(form.tipo) }}
                    {{ render_field(form.nivel) }}
                    {{ render_field(form.precio) }}
                
                    <input type="submit" class="btn btn-primary" value="Registrar">
                </form>
            </div>
            <table class="tablaBicicletas">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Marca</th>
                        <th>Modelo</th>
                        <th>Tama√±o de aro</th>
                        <th>Color</th>
                        <th>Tipo</th>
                        <th>Nivel</th>
                        <th>Precio</th>
                    </tr>
                </thead>
                <tbody> 
                    <tr>
                        {% for bicicleta in bicicletas %}
                        <td id = "bicicleta">
                            {{ bicicleta.id }}
                        </td>
                        <td>
                            <button id="{{bicicleta.id}}" onclick="show_data({{ bicicleta.id }})" class="">{{ bicicleta.marca }}</button>
                        </td>
                        <td>
                            {{ bicicleta.modelo }}
                        </td>
                        <td>
                            {{ bicicleta.aro }}
                        </td>
                        <td>
                            {{ bicicleta.color }}
                        </td>
                        <td>
                            {{ bicicleta.tipo }}
                        </td>
                        <td>
                            {{ bicicleta.nivel }}
                        </td>
                        <td>
                            {{ bicicleta.precio }}
                        </td>
                        <td>
                            <a href="actualizar/{{ bicicleta.id }}">
                                <button id="{{ bicicleta.id }}" onclick="update_data({{ bicicleta.id }})" class="">Actualizar</button>
                            </a>
                        </td>
                        <td>
                            <a href="delete/{{bicicleta.id}}">
                                <button id="{{bicicleta.id}}" onclick="delete_data({{ bicicleta.id }})" class="">Borrar</button>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
        <div id="show-info" class="hidden">
            <div class="box">
                <div id="content">
                    <h1>Datos de la bicicleta</h1>
                    <ul id="todos">

                    </ul>
                    <button onclick="ocultar()">Cerrar</button>
                </div>
            </div>
        </div>
    </body>
    <script>
        function show_data(user){
            document.getElementById("todos").innerHTML = '';
            fetch('/show-data/' + user,{
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(function(response){
                return response.json();
            }).then(function(responseJSON){
                const li1 = document.createElement('li');
                const li2 = document.createElement('li');
                const li3 = document.createElement('li');
                const li4 = document.createElement('li');
                const li5 = document.createElement('li');
                const li6 = document.createElement('li');
                const li7 = document.createElement('li');
                const li8 = document.createElement('li');

                li1.innerHTML = responseJSON['user'];
                li2.innerHTML = responseJSON['Marca'];
                li3.innerHTML = responseJSON['Modelo'];
                li4.innerHTML = responseJSON['Aro'];
                li5.innerHTML = responseJSON['Color'];
                li6.innerHTML = responseJSON['Tipo'];
                li7.innerHTML = responseJSON['Nivel'];
                li8.innerHTML = responseJSON['Precio'];

                document.getElementById("todos").appendChild(li1);
                document.getElementById("todos").appendChild(li2);
                document.getElementById("todos").appendChild(li3);
                document.getElementById("todos").appendChild(li4);
                document.getElementById("todos").appendChild(li5);
                document.getElementById("todos").appendChild(li6);
                document.getElementById("todos").appendChild(li7);
                document.getElementById("todos").appendChild(li8);

                document.getElementById('show-info').className = '';
            })
        }

        function ocultar(){
            document.getElementById('show-info').className = 'hidden';
        }

        function update_data(user){
            fetch('/actualizar/' + user,{
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(function(response){
                return response.json();
            }).then(function(responseJSON){
            })
        }

        function delete_data(id){
            fetch('/delete/'+id,{
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(function(response){
                return response.json();
            }).then(function(responseJson){
                location.reload();
            })
        }
    </script>
</html>